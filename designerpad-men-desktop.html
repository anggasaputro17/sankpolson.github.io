<link rel="stylesheet" href="//static.zalora.com/css/global.css">
<link rel="stylesheet" href="//static.zalora.com/css/onsite.css">

<style>
    #BannersTop.hpBannersTop{display:block!important}
    .b-mainBanner,#Brands.hpBrands,#Topsellers.hpTopsellers{display:none!important}
    body{background:#fff!important}
    .cms-fallback{display: none;}
    #cms-link-spec-inc > div.cms-container > a:hover {text-decoration: none!important;}

    .cms-sp-primary-neg-mtop {
        margin-top: -125px;
    }

    .cms-sp-primary-mleft {
        margin-left: 30px;
    }

    .cms-sp-secondary-mleft {
        margin-left: 290px;
    }
    .cms-sp-banner-copy {
        position: absolute;
        z-index: 2;
        width: 270px;
        padding-left: 15px;
        padding-top: 10px;
        padding-right: 15px;
        background: #fff;
        color: #000;
        bottom: -390px; 
        line-height: 1.5; 
    }

    .cms-sp-fallback-banner-copy {
        position: absolute;
        z-index: 2;
        width: 270px;
        padding-left: 15px;
        padding-top: 10px;
        padding-right: 15px;
        background: #fff;
        line-height: 1.5; 
        bottom: -100px; 
    }    

    .cms-section-heading {
        text-transform: none;
        font-size: 28px;
        padding-bottom: 0px;
        border-bottom: 0px;
        color: #ED1E24;
    }

    .cms-sp-sm-img {
        width: 360px;
        height: 420px;
        overflow: hidden
    }

    .cms-sp-sm-cat-img {
        width: 296px;
        height: 195px;
    }

    .cms-sp-lg-cat-img {
        width: 374px;
        height: 500px;
    }

    .cms-sp-lg-img {
        width: 620px;
        height: 420px;
        overflow: hidden
    }

    ul.cms-tabs {
        width: 996px;
        border-bottom: none;
    }
    ul.cms-tabs li.cms-sis-tabs {
        padding-left: 0px;
        padding-right: 0px;		
        padding-top: 10px;
        padding-bottom: 5px;
        letter-spacing: 2px;
        text-transform: uppercase;  
    }
    ul.cms-tabs li.current {
        background: #fff;
        color: #000;
        border-bottom: 1px solid #000;
    }
    .cms-sp-cat-grid-mtop {
        margin-top: 110px;
    }

    .cms-magazine-cover {
        width: 996px;
        padding-top: 40px;
        height: 240px;
    }

    .cms-brand-placeholders {
        height: 165px;
    }
    .cms-cat-spacer2 {margin-bottom:79px;}

    .cms-sp-banner-copy2 {bottom: -90px !important;}

    .cms-magazine-sp-hero a:hover .btn {
        background: #000;
        color: #fff;
    }
</style>

<div id="cms-link-spec-inc" class="cms-container" style="visibility:visible">

    <!-- Hero Banner Row Start -->
    <div class="cms-row"> 
        <div class="cms-full mtm">
            <a href="/women/special-price/" id="js-h1-exiturl" class="cms-top-brands">
                <img id="js-h1-img" src="" class="">
            </a>
        </div>
    </div>
    <!-- Hero Banner Row End -->

    <!-- NewA Section Start -->
    <div class="cms-row">
        <div class="cms-full mtxxl txtCenter">
            <div id="js-na-title" class="cms-section-heading"></div>
        </div>
        <div class="cms-full mtl">
            <!-- EG N1 Start -->
            <a class="lfloat txtCenter cms-banner-cta-combo cms-animate" id="js-n1-exiturl" href="">
                <div class="cms-sp-sm-img cms-top-brands">
                    <img id="js-n1-img" src="" width="360" height="420" class="cms-animate">
                </div>
                <div class="cms-sp-primary-neg-mtop cms-sp-primary-mleft">
                    <div class="cms-sp-banner-copy2 cms-sp-banner-copy">
                        <div id="js-n1-headcopy" class="cms-hp-b13-headline txtUpper txtLeft">
                        </div>
                        <p class="txtLeft">
                            <span id="js-n1-bodycopy">
                            </span>
                        </p>
                    </div>
                </div>
            </a>
            <!-- EG N2 Start -->
            <a id="js-n2-exiturl" class="rfloat txtCenter cms-banner-cta-combo cms-animate" href="">
                <div class="cms-sp-lg-img cms-top-brands">
                    <img id="js-n2-img" src="" width="620" height="420" class="cms-animate">
                </div>
                <div class="cms-sp-primary-neg-mtop cms-sp-secondary-mleft">
                    <div class="cms-sp-banner-copy2 cms-sp-banner-copy">
                        <div id="js-n2-headcopy" class="cms-hp-b13-headline txtUpper txtLeft">
                        </div>
                        <p class="txtLeft">
                            <span id="js-n2-bodycopy">
                            </span>
                        </p>
                    </div>
                </div>
            </a>
        </div>
    </div>
    <!-- NewA Section End -->

    <!-- Add spacers to fix negative margins -->
    <div class="cms-row">
        <div class="cms-full mtxxl">
            <div class="cms-spacer-35"></div>
        </div>
    </div>

    <!-- Shop By Subcat Section Start -->
    <div class="cms-row">
        <div class="cms-full mtxxl txtCenter">
            <div id="js-ct-title" class="cms-section-heading"></div>
        </div>

        <div class="cms-full mtl">
            <div class="lfloat">
                <!-- EG C1 -->
                <a id="js-c1-exiturl" class="txtCenter" href="">
                    <div class="cms-sp-sm-cat-img cms-top-brands">
                        <img id="js-c1-img" src="" width="296" height="195" class="cms-animate">
                    </div>
                    <div class="cms-spacer-10">
                    </div>
                    <div class="cms-cat-spacer2 cms-hp-b13-headline">
                        <span id="js-c1-bodycopy">
                        </span>
                    </div>
                </a>

                <!-- EG C2 -->
                <a id="js-c2-exiturl" class="txtCenter" href="">
                    <div class="cms-sp-sm-cat-img cms-top-brands">
                        <img class="cms-animate" id="js-c2-img" src="" width="296" height="195">
                    </div>
                    <div class="cms-spacer-10">
                    </div>
                    <div class="cms-cat-spacer2 cms-hp-b13-headline">
                        <span id="js-c2-bodycopy">
                        </span>
                    </div>
                </a>
            </div>
            <div class="lfloat cms-spacer-3grid">
                <!-- EG C3 -->
                <a id="js-c3-exiturl" class="txtCenter" href="">
                    <div class="cms-sp-lg-cat-img cms-top-brands">
                        <img id="js-c3-img" src="" width="374" height="500" class="cms-animate">
                    </div>
                    <div class="cms-spacer-10">
                    </div>
                    <div class="cms-cat-spacer2 cms-hp-b13-headline">
                        <span id="js-c3-bodycopy">
                        </span>
                    </div>
                </a>
            </div>
            <div class="lfloat cms-spacer-3grid">
                <!-- EG C4 -->
                <a id="js-c4-exiturl" class="txtCenter" href="">
                    <div class="cms-sp-sm-cat-img cms-top-brands">
                        <img id="js-c4-img" src="" width="296" height="195" class="cms-animate">
                    </div>
                    <div class="cms-spacer-10">
                    </div>
                    <div class="cms-cat-spacer2 cms-hp-b13-headline">
                        <span id="js-c4-bodycopy">
                        </span>
                    </div>
                </a>
                <!-- EG C5 -->
                <a id="js-c5-exiturl" class="txtCenter" href="">
                    <div class="cms-sp-sm-cat-img cms-top-brands">
                        <img class="cms-animate" id="js-c5-img" src="" width="296" height="195">
                    </div>
                    <div class="cms-spacer-10">
                    </div>
                    <div class="cms-cat-spacer2 cms-hp-b13-headline">
                        <span id="js-c5-bodycopy">
                        </span>
                    </div>
                </a>
            </div>
        </div>
    </div> 
    
    <!-- Discover our brands Section Start -->
    <div class="cms-row">
        <div class="cms-full mtl txtCenter">
            <div id="js-bd-title" class="cms-section-heading"></div>
        </div>        
    </div>

    <!-- Brands TABS -->
    <div class="cms-row txtCenter">

        <!-- Fashion Brands Tab -->
        <div class="cms-full current cms-tab-content txtCenter">
            <div class="cms-full mtl cms-brand-placeholders">               
                <!-- EG FB1 -->
                <div class="lfloat cms-top-brands">
                    <a id="js-fb1-exiturl" href="">
                        <img id="js-fb1-img" src="" alt="" class="">
                    </a>
                </div>

                <!-- EG FB2 -->
                <div class="lfloat cms-spacer-3grid cms-top-brands">
                    <a id="js-fb2-exiturl" href="">
                        <img id="js-fb2-img" src="" alt="" class="">
                    </a>
                </div>

                <!-- EG FB3 -->
                <div class="lfloat cms-spacer-3grid cms-top-brands">
                    <a id="js-fb3-exiturl" href="">
                        <img id="js-fb3-img" src="" alt="" class="">
                    </a>
                </div>
            </div>
            <div class="cms-full mtm cms-brand-placeholders">
                <!-- EG FB4 -->
                <div class="lfloat cms-top-brands">
                    <a id="js-fb4-exiturl" href="">
                        <img id="js-fb4-img" src="" alt="" class="">
                    </a>
                </div>

                <!-- EG FB5 -->
                <div class="lfloat cms-spacer-3grid cms-top-brands">
                    <a id="js-fb5-exiturl" href="">
                        <img id="js-fb5-img" src="" alt="" class="">
                    </a>
                </div>

                <!-- EG FB6 -->
                <div class="lfloat cms-spacer-3grid cms-top-brands">
                    <a id="js-fb5-exiturl" href="" class="" >
                        <img id="js-fb6-img" src="" alt="" class="">
                    </a>
                </div>
            </div>
        </div>
        <!-- Fashion Brands Tab -->
    </div>

    <!-- Explore More Brands CTA -->
    <div class="cms-row">
        <div class="cms-full mtxl ptl txtCenter">
            <a href="/brands" class="btn btn--secondary btn--cta">Explore More Brands</a>
        </div>        
    </div>
    <!-- Discover our brands Section End --> 

</div>
<!-- Shop by Subcat Section End -->

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>
    function fetchDataFromExcel() {
        var createLooperObject = [];
        var fetchedData;
        var spreadsheetID = "1wYQ1pqEUyYPVonghDC677Mzq_hd2Lrguc2S5rh4ouXA";
        var worksheetID = 3;
        var url = "https://spreadsheets.google.com/feeds/list/" + spreadsheetID + "/" + worksheetID + "/public/values?alt=json";
        $.getJSON(url, function (data) {
            fetchedData = data.feed.entry;
            for (var i = 0; i < fetchedData.length; i++) {
                createLooperObject.push(
                        {
                            placement: fetchedData[i]['gsx$placement']['$t'],
                            imageURL: fetchedData[i]['gsx$image']['$t'],
                            exitURL: fetchedData[i]['gsx$exiturl']['$t'],
                            headline: fetchedData[i]['gsx$headline']['$t'],
                            subline: fetchedData[i]['gsx$subline']['$t']
                        }
                );
            }
            console.log(createLooperObject);

            displayDataUsingHandlebars(createLooperObject);

        });
    }

    function fetchSectionTitles() {
        var createLooperObject = [];
        var fetchedData;
        var spreadsheetID = "1wYQ1pqEUyYPVonghDC677Mzq_hd2Lrguc2S5rh4ouXA";
        var worksheetID = 2;
        var url = "https://spreadsheets.google.com/feeds/list/" + spreadsheetID + "/" + worksheetID + "/public/values?alt=json";
        $.getJSON(url, function (data) {
            fetchedData = data.feed.entry;
            for (var i = 0; i < fetchedData.length; i++) {
                createLooperObject.push(
                        {
                            placement: fetchedData[i]['gsx$code']['$t'],
                            title: fetchedData[i]['gsx$headline']['$t']
                        }
                );
            }
            console.log(createLooperObject);

            displaySectionTitles(createLooperObject);

        });
    }

    function displayDataUsingHandlebars(data) {
        for (var i = 0; i < data.length; i++) {
            $("#js-" + data[i]['placement'] + "-img").attr("src", data[i]['imageURL']);
            $("#js-" + data[i]['placement'] + "-exiturl").attr("href", data[i]['exitURL']);
            $("#js-" + data[i]['placement'] + "-headcopy").html(data[i]['headline']);
            $("#js-" + data[i]['placement'] + "-bodycopy").html(data[i]['subline']);
        }
    }
    
    function displaySectionTitles(data) {
        for (var i = 0; i < data.length; i++) {
            $("#js-" + data[i]['placement'] + "-title").html(data[i]['title']);
        }
    }

    $(function () {
        fetchDataFromExcel();
        fetchSectionTitles();
    });
</script>
